<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.advu.workflow.dao.database.ZwscDashangMapper">
    
    <sql id="conditions">
        <where>
            <if test="startTime != '' and startTime != null">
                AND dt &gt;= #{startTime}
            </if>
            <if test="endTime != '' and endTime != null">
                AND dt &lt;= #{endTime}
            </if>
        </where>
    </sql>
    
    <select id="getAmtDataByDay" resultType="Map">
		SELECT
		    dt AS timeCycle,
			IFNULL(SUM(ds_money),0) AS moneySum,
			IFNULL(SUM(ds_times),0) AS timeSum,
			IFNULL(SUM(ds_user),0) AS userSum
		FROM
		    zwsc_dashang
		<include refid="conditions"></include>
		GROUP BY
		    timeCycle    
    </select>
    
    <select id="getAmtDataByWeek" resultType="Map">
		SELECT
		    DATE_FORMAT(dt,'%Y-%u') AS timeCycle,
			IFNULL(SUM(ds_money),0) AS moneySum,
			IFNULL(SUM(ds_times),0) AS timeSum,
			IFNULL(SUM(ds_user),0) AS userSum
		FROM
		    zwsc_dashang
        <include refid="conditions"></include>		    
		GROUP BY
		    timeCycle    
    </select>
    
    <select id="getAmtDataByMonth" resultType="Map">
		SELECT
		    DATE_FORMAT(dt,'%Y-%m') AS timeCycle,
			IFNULL(SUM(ds_money),0) AS moneySum,
			IFNULL(SUM(ds_times),0) AS timeSum,
			IFNULL(SUM(ds_user,0)) AS userSum
		FROM
		    zwsc_dashang
		<include refid="conditions"></include>    
		GROUP BY
		    timeCycle    
    </select>
    
    <select id="getSummaryData" resultType="Map">
		SELECT
			IFNULL(SUM(ds_money),0) AS moneySum,
			IFNULL(SUM(ds_times),0) AS timeSum,
			IFNULL(SUM(ds_user),0) AS userSum
		FROM
		    zwsc_dashang    
        <include refid="conditions"></include>		    
    </select>
    
    <select id="getTypeData" resultType="Map">
		SELECT
		    ds_type AS dsType,
		    IFNULL(SUM(ds_money),0) AS moneySum,
			IFNULL(SUM(ds_times),0) AS timeSum,
			IFNULL(SUM(ds_user),0) AS userSum
		FROM
		    zwsc_dashang
		<include refid="conditions"></include>
		GROUP BY
		    ds_type    
    </select>
</mapper>