## 引入css
#define($cssblock)
<link href="#springUrl("")/static/css/plugins/switchery/switchery.css?$!application.getAttribute('/static/css/plugins/switchery/switchery.css')" rel="stylesheet">
#end

<div class="ibox-content">
    <form class="form-horizontal m-t" id="commentForm">
        <div class="form-group">
            <label class="col-sm-3 control-label">角色名称:</label>
            <div class="col-sm-8">
                <input id="role_name" name="role_name" maxlength="50" type="text" class="form-control" required="" aria-required="true">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">角色描述:</label>
            <div class="col-sm-8">
                <input id="description" name="description" maxlength="100" type="text" class="form-control" >
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">角色名称（activiti内部用名）:</label>
            <div class="col-sm-8">
                <input id="activiti_name" name="activiti_name" maxlength="50" type="text" class="form-control" required="" aria-required="true">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">是否是系统用户:</label>
            <div class="col-sm-8">
                <input id="is_system" name="is_system" type="checkbox" class="js-switch"
##                       checked
                />
            </div>
        </div>

        <div class="form-group">
            <div class="col-sm-4 col-sm-offset-3">
                <button class="btn btn-primary" type="submit"><i class="fa fa-check"></i> 保存</button>
            </div>
            <div class="col-sm-3 col-sm-offset-1">
                <button class="btn btn-default" type="button"><i class="fa fa-reply"></i> 取消</button>
            </div>
        </div>
    </form>
</div>




## 引入js
#define($jsblock)
<script type="text/javascript" src="#springUrl("")/static/js/plugins/switchery/switchery.js?$!application.getAttribute('/static/js/plugins/switchery/switchery.js')"></script>
<script type="text/javascript" src="#springUrl("")/static/js/plugins/validate/jquery.validate.min.js?$!application.getAttribute('/static/js/plugins/validate/jquery.validate.min.js')"></script>
<script type="text/javascript" src="#springUrl("")/static/js/plugins/validate/messages_zh.min.js?$!application.getAttribute('/static/js/plugins/validate/messages_zh.min.js')"></script>

<script>
    $.validator.setDefaults(
        {highlight:function(e){$(e).closest(".form-group").removeClass("has-success").addClass("has-error")},
            success:function(e){
                e.closest(".form-group").removeClass("has-error").addClass("has-success")
            },
            errorElement:"span",
            errorPlacement:function(e,r){e.appendTo(r.is(":radio")||r.is(":checkbox")?r.parent().parent().parent():r.parent())},
            errorClass:"help-block m-b-none",validClass:"help-block m-b-none"}
    ),
    $().ready(
        function(){
            var e="<i class='fa fa-times-circle'></i> ";
            $("#commentForm").validate({
                submitHandler:function(form){
                    addRegion();
                }
            });
            {var i=document.querySelector(".js-switch"),
                    t=(new Switchery(i,{color:"#1AB394"}));
            };
        }
    );
//            $.validator.setDefaults(
//                    {highlight:function(e){$(e).closest(".form-group").removeClass("has-success").addClass("has-error")},
//                        success:function(e){
//                            e.closest(".form-group").removeClass("has-error").addClass("has-success")
//                        },
//                        errorElement:"span",
//                        errorPlacement:function(e,r){e.appendTo(r.is(":radio")||r.is(":checkbox")?r.parent().parent().parent():r.parent())},
//                        errorClass:"help-block m-b-none",validClass:"help-block m-b-none"}
//            ),

//    $(function(){
//        //获取角色信息添加到select中
//        setRoles();
//    });

##    function setRoles(){
##        $.ajax({
##            url:"${rc.contextPath}/role/getAll.json",
##            type:"POST",
##            success: function(returnData){
##                var selHtml = "";
##                $.each(returnData.data, function(i, item){
##                    selHtml += "<option value='"+item.roleId+"'>"+item.roleName+"</option>";
##                });
##                $("#roleSel").html(selHtml);
##            }
##        });
##    }

//    $(".btn-primary").click(function(){
//        addRole();
//    })

    function addRegion(){
        var activitiName = $("#activiti_name").val();
        var name = $("#role_name").val();
        var description = $("#description").val();
        var is_system = $(".js-switch")[0].checked;
        $.ajax({
            url:"/role/add.json",
            type:"post",
            async: false,
            data:{
                activitiName:activitiName,
                name:name,
                description:description,
                isSystem:is_system
            },
            success: function(returnData){
                if(returnData.code == 1){
                    popMsg('添加成功!', "/role/index");
                } else{
                    layer.msg('添加失败, 请联系技术人员!');
                }
            }

        });
    }

    // 返回
    $(".btn-default").click(function(){
        history.go(-1);
    })
</script>
#end